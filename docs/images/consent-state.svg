<svg xmlns="http://www.w3.org/2000/svg" style="max-width:861.34375px" id="mermaidChart180" height="100%" viewBox="0 0 861.344 1040.775"><style>.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.arrowheadPath{fill:green}.edgePath .path{stroke:green;stroke-width:1.5px}.edgeLabel{background-color:#e8e8e8}svg{color:rgba(0,0,0,.65);font:400 12px/18px &quot;Helvetica Neue For Number&quot;,-apple-system,BlinkMacSystemFont,&quot;Segoe UI&quot;,Roboto,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;Helvetica Neue&quot;,Helvetica,Arial,sans-serif}</style><g><g class="output"><g class="edgePaths"><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11751)" d="M386.421875,92.23749847412103L385.921875,125.73750305175781L386.421875,160.2375045776367" class="path"/><defs><marker id="arrowhead11751" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11752)" d="M386.421875,261.5375015258788L385.921875,295.0375061035156L385.921875,329.0375061035156" class="path"/><defs><marker id="arrowhead11752" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11753)" d="M362.6704009433962,367.0375061035156L321.0625,401.0375061035156L321.0625,454.0375061035156L321.0625,507.0375061035156L362.6704009433962,541.0375061035156" class="path"/><defs><marker id="arrowhead11753" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11754)" d="M409.1733490566038,367.0375061035156L450.78125,401.0375061035156L450.78125,435.0375061035156" class="path"/><defs><marker id="arrowhead11754" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11755)" d="M536.90625,441.66610903311084L583.0520833333333,435.0375061035156L594.5885416666667,435.0375061035156L606.125,454.0375061035156L594.5885416666667,473.0375061035156L583.0520833333333,473.0375061035156L536.90625,466.4089031739204" class="path"/><defs><marker id="arrowhead11755" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11756)" d="M450.78125,473.0375061035156L450.78125,507.0375061035156L409.1733490566038,541.0375061035156" class="path"/><defs><marker id="arrowhead11756" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11757)" d="M385.921875,579.0375061035156L385.921875,604.0375061035156L385.921875,629.0375061035156" class="path"/><defs><marker id="arrowhead11757" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11758)" d="M309.6221992924528,667.0375061035156L173.0859375,701.0375061035156L173.0859375,735.0375061035156" class="path"/><defs><marker id="arrowhead11758" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11759)" d="M462.2215507075472,667.0375061035156L598.7578125,701.0375061035156L598.7578125,735.0375061035156" class="path"/><defs><marker id="arrowhead11759" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11760)" d="M173.0859375,773.0375061035156L173.0859375,798.0375061035156L294.0154474431818,823.0375061035156" class="path"/><defs><marker id="arrowhead11760" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11761)" d="M598.7578125,773.0375061035156L598.7578125,798.0375061035156L477.8283025568182,823.0375061035156" class="path"/><defs><marker id="arrowhead11761" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath"><path style="fill:none" marker-end="url(#arrowhead11762)" d="M385.921875,861.0375061035156L385.921875,895.0375061035156L386.421875,929.5375076293946" class="path"/><defs><marker id="arrowhead11762" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g></g><g class="edgeLabels"><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(385.921875,125.73750305175781) translate(-129.7578125,-9)"><foreignObject width="259.516" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Redirects to consent app with consent request ID</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(385.921875,295.0375061035156) translate(-57.9609375,-9)"><foreignObject width="115.922" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Initiates Consent Flow</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(321.0625,454.0375061035156) translate(-8.59375,-9)"><foreignObject width="17.188" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">yes</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(450.78125,401.0375061035156) translate(-6.9140625,-9)"><foreignObject width="13.828" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">no</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(606.125,454.0375061035156) translate(-34.21875,-9)"><foreignObject width="68.438" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Sign in failed</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(450.78125,507.0375061035156) translate(-46.1484375,-9)"><foreignObject width="92.297" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Sign in successful</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(173.0859375,701.0375061035156) translate(-67.4765625,-9)"><foreignObject width="134.953" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">User denies authorization</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(598.7578125,701.0375061035156) translate(-70.1171875,-9)"><foreignObject width="140.234" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">User accepts authorization</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(385.921875,895.0375061035156) translate(-73.859375,-9)"><foreignObject width="147.719" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Redirect to redirectUrl value</span></div></foreignObject></g></g></g><g class="nodes"><g id="H" class="node" transform="translate(385.921875,55.868751525878906)" style="opacity:1"><polygon points="35.869 0 71.737 -35.869 35.869 -71.737 0 -35.869" rx="5" ry="5" transform="translate(-35.86875,35.86875)"/><g class="label"><g transform="translate(0,0) translate(-15.8359375,-9)"><foreignObject width="31.672" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Hydra</div></foreignObject></g></g></g><g id="C" class="node" transform="translate(385.921875,210.38750457763672)" style="opacity:1"><polygon points="50.65 0 101.3 -50.65 50.65 -101.3 0 -50.65" rx="5" ry="5" transform="translate(-50.650000000000006,50.650000000000006)"/><g class="label"><g transform="translate(0,0) translate(-34.3125,-9)"><foreignObject width="68.625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Consent App</div></foreignObject></g></g></g><g id="CA" class="node" transform="translate(385.921875,348.0375061035156)" style="opacity:1"><rect width="172.906" height="38" x="-86.453" y="-19" rx="5" ry="5"/><g class="label"><g transform="translate(0,0) translate(-76.453125,-9)"><foreignObject width="152.906" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Is the user signed in already?</div></foreignObject></g></g></g><g id="CG" class="node" transform="translate(385.921875,560.0375061035156)" style="opacity:1"><rect width="282.063" height="38" x="-141.031" y="-19" rx="5" ry="5"/><g class="label"><g transform="translate(0,0) translate(-131.03125,-9)"><foreignObject width="262.063" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Fetch consent request from Hydra using REST API</div></foreignObject></g></g></g><g id="CL" class="node" transform="translate(450.78125,454.0375061035156)" style="opacity:1"><rect width="172.25" height="38" x="-86.125" y="-19" rx="5" ry="5"/><g class="label"><g transform="translate(0,0) translate(-76.125,-9)"><foreignObject width="152.25" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Sign user in using login form</div></foreignObject></g></g></g><g id="CC" class="node" transform="translate(385.921875,648.0375061035156)" style="opacity:1"><rect width="227.406" height="38" x="-113.703" y="-19" rx="5" ry="5"/><g class="label"><g transform="translate(0,0) translate(-103.703125,-9)"><foreignObject width="207.406" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Ask user to authorize requested scopes</div></foreignObject></g></g></g><g id="CHD" class="node" transform="translate(173.0859375,754.0375061035156)" style="opacity:1"><rect width="306.172" height="38" x="-153.086" y="-19" rx="5" ry="5"/><g class="label"><g transform="translate(0,0) translate(-143.0859375,-9)"><foreignObject width="286.172" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Tell Hydra to deny the consent request using REST API</div></foreignObject></g></g></g><g id="CHA" class="node" transform="translate(598.7578125,754.0375061035156)" style="opacity:1"><rect width="445.172" height="38" x="-222.586" y="-19" rx="5" ry="5"/><g class="label"><g transform="translate(0,0) translate(-212.5859375,-9)"><foreignObject width="425.172" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Tell Hydra to accept the consent request with the granted scopes using REST API</div></foreignObject></g></g></g><g id="CHR" class="node" transform="translate(385.921875,842.0375061035156)" style="opacity:1"><rect width="298.328" height="38" x="-149.164" y="-19" rx="5" ry="5"/><g class="label"><g transform="translate(0,0) translate(-139.1640625,-9)"><foreignObject width="278.328" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Read redirectUrl value from consent request payload</div></foreignObject></g></g></g><g id="H2" class="node" transform="translate(385.921875,964.9062576293945)" style="opacity:1"><polygon points="35.869 0 71.737 -35.869 35.869 -71.737 0 -35.869" rx="5" ry="5" transform="translate(-35.86875,35.86875)"/><g class="label"><g transform="translate(0,0) translate(-15.8359375,-9)"><foreignObject width="31.672" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Hydra</div></foreignObject></g></g></g></g></g></g></svg>